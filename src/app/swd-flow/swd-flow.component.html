<sqd-designer
  theme="light"
  [undoStackSize]="10"
  [definition]="definition"
  [toolboxConfiguration]="toolboxConfiguration"
  [stepsConfiguration]="stepsConfiguration"
  [validatorConfiguration]="validatorConfiguration"
  [controlBar]="true"
  [selectedStepId]="selectedStepId"
  [isReadonly]="isReadonly"
  [isToolboxCollapsed]="isToolboxCollapsed"
  [isEditorCollapsed]="false"
  [areEditorsHidden]="false"
  [rootEditor]="rootEditor"
  [stepEditor]="stepEditor"
  (onReady)="onDesignerReady($event)"
  (onDefinitionChanged)="onDefinitionChanged($event)"
  (onSelectedStepIdChanged)="onSelectedStepIdChanged($event)"
  (onIsToolboxCollapsedChanged)="onIsToolboxCollapsedChanged($event)"
  (onIsEditorCollapsedChanged)="onIsEditorCollapsedChanged($event)"
>
</sqd-designer>

<ng-template #rootEditor let-editor>
  <h2>Root Editor</h2>
  <h3>Variables</h3>
</ng-template>

<ng-template #stepEditor let-editor>
  <h2>{{editor.step.name}}</h2>

  <ng-container *ngIf="editor.step.type === 'controlFlow'">
    <mat-form-field class="full-width">
      <mat-label>Condition</mat-label>
      <input
        matInput
        type="text"
        [value]="editor.step.properties.condition"
        [readonly]="editor.isReadonly"
        (input)="updateProperty(editor.step, 'condition', $event.target, editor.context)"
      />
    </mat-form-field>
  </ng-container>

  <ng-container *ngIf="editor.step.type === 'screen'">
    <mat-form-field class="full-width">
      <mat-label>Screen Name</mat-label>
      <mat-select
        [value]="editor.step.properties.screenId"
        (selectionChange)="updateProperty(editor.step, 'screenId', $event, editor.context)"
      >
        <mat-option [value]="'registration'">Registration</mat-option>
      </mat-select>
    </mat-form-field>
  </ng-container>

  <ng-container *ngIf="editor.step.type === 'action'">
    <mat-form-field class="full-width">
      <mat-label>Action Name</mat-label>
      <mat-select
        [value]="editor.step.properties.screenId"
        (selectionChange)="updateProperty(editor.step, 'action', $event, editor.context)"
      >
        <mat-option [value]="'createAccount'">Create Account</mat-option>
        <mat-option [value]="'sendEmail'">Send Email</mat-option>
      </mat-select>
    </mat-form-field>
  </ng-container>
</ng-template>

<div class="block">
  <button mat-button type="button" (click)="saveFlow()" mat-raised-button color="primary">Save Flow</button>
</div>
